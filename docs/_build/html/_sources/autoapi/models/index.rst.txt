:py:mod:`models`
================

.. py:module:: models

.. autoapi-nested-parse::

   Provides models for accounting objects.



Submodules
----------
.. toctree::
   :titlesonly:
   :maxdepth: 1

   account/index.rst
   assignment/index.rst
   balance/index.rst
   base/index.rst
   category/index.rst
   currency/index.rst
   entity/index.rst
   ledger/index.rst
   line_item/index.rst
   recyclable/index.rst
   recyled/index.rst
   reporting_period/index.rst
   tax/index.rst
   transaction/index.rst
   user/index.rst


Package Contents
----------------

Classes
~~~~~~~

.. autoapisummary::

   models.Base
   models.Recyclable
   models.Currency
   models.User
   models.Recycled
   models.ReportingPeriod
   models.Entity
   models.Account
   models.Category
   models.LineItem
   models.Transaction
   models.Balance
   models.Tax
   models.Ledger
   models.Assignment




.. py:class:: Base


   Bases: :py:obj:`sqlalchemy.orm.DeclarativeBase`

   The accounting model base class

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the model database record.

      :type: id (int)

   .. py:attribute:: created_at
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The time the database record was created.

      :type: created_at (datetime)

   .. py:attribute:: updated_at
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The time the database record was last modified.

      :type: update_at (datetime)

   .. py:method:: __tablename__() -> str



.. py:class:: Recyclable


   Bases: :py:obj:`python_accounting.models.Base`

   Interface for associating recycled objects with its models.

   .. py:attribute:: deleted_at
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The time the model was recycled.

      :type: (`datetime`, optional)

   .. py:attribute:: destroyed_at
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The time the model was recycled permanently deleted.

      :type: (`datetime`, optional)

   .. py:attribute:: recycled_type
      :type: sqlalchemy.orm.Mapped[str]

      The class name of the recycled model.

      :type: (str)

   .. py:attribute:: history
      :type: sqlalchemy.orm.Mapped[List[Recycled]]

      A list of deletions and restorations for the model.

      :type: (list)

   .. py:attribute:: __mapper_args__

      


.. py:class:: Currency


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.Recyclable`

   Represents a Currency in terms of a label and an ISO Currency Code.

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Category database record.

      :type: (int)

   .. py:attribute:: name
      :type: sqlalchemy.orm.Mapped[str]

      The label of the Currency.

      :type: (str)

   .. py:attribute:: code
      :type: sqlalchemy.orm.Mapped[str]

      The ISO 4217 currency code symbol.

      :type: (str)

   .. py:method:: __repr__() -> str



.. py:class:: User


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`models.base.Base`

   Represents an authenticatable User with access to an Entity.

   .. py:attribute:: name
      :type: sqlalchemy.orm.Mapped[str]

      The name of the User.

      :type: (str)

   .. py:attribute:: email
      :type: sqlalchemy.orm.Mapped[str]

      A unique email to identify the User.

      :type: (str)

   .. py:method:: __repr__() -> str

      Return repr(self).



.. py:class:: Recycled


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`models.base.Base`

   Represents an accounting model that has been recycled.

   .. py:attribute:: recycled_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the model that has been recycled.

      :type: (int)

   .. py:attribute:: restored_at
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The time the model was restored.

      :type: (`datetime`, optional)

   .. py:attribute:: subject
      :type: sqlalchemy.orm.Mapped[Recyclable]

      The model that was recycled/restored.

      :type: (Recyclable)

   .. py:method:: __repr__() -> str

      Return repr(self).



.. py:class:: ReportingPeriod


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.Recyclable`

   Represents a financial cycle for the Reporting Entity.

   .. py:class:: Status(*args, **kwds)


      Bases: :py:obj:`enum.Enum`

      Represents a Reporting Period's status.

      .. py:attribute:: OPEN
         :value: 0

         The period is current and Transactions may be posted to it.

      .. py:attribute:: ADJUSTING
         :value: 1

         The period is past and only Journal Entry Transactions may be posted to
         it (E.g Audit Adjustments).

      .. py:attribute:: CLOSED
         :value: 2

         The period is past and no more Transactions may be posted to it.


   .. py:attribute:: __tablename__
      :value: 'reporting_period'

      

   .. py:attribute:: __table_args__
      :value: ()

      

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Reporting Period database record.

      :type: (int)

   .. py:attribute:: calendar_year
      :type: sqlalchemy.orm.Mapped[int]

      The calendar year associated with the ReportingPeriod.

      :type: (int)

   .. py:attribute:: period_count
      :type: sqlalchemy.orm.Mapped[int]

      The number of periods since the system has been in use by the Entity.

      :type: (int)

   .. py:attribute:: status
      :type: sqlalchemy.orm.Mapped[ReportingPeriod.Status]

      The status of the Reporting Period.

      :type: (ReportingPeriod.Status)

   .. py:method:: __repr__() -> str


   .. py:method:: date_year(date: datetime.datetime = None, entity=None) -> int
      :staticmethod:

      Returns the calendar year for the given date.

      :param date: The date whose calendar year is
                   to be found. Defaults to the current date.
      :type date: `datetime`, optional
      :param entity: The Entity for whom the calendar year
                     is to be found. If absent, defaults to the calendar year.
      :type entity: `int`, optional

      :returns: The calendar year.
      :rtype: int


   .. py:method:: get_period(session, date: datetime.datetime) -> ReportingPeriod
      :staticmethod:

      Returns the reporting period for the given date.

      :param session: The accounting session to which the Reporting Period
                      belongs.
      :type session: Session
      :param date: The date whose Reporting Period is to be found.
      :type date: datetime

      :raises MissingReportingPeriodError: If there no Reporting Period exists for the
          given date.

      :returns: The Reporting Period.
      :rtype: ReportingPeriod


   .. py:method:: validate(session) -> None

      Validates the Reporting Period properties.

      :param session: The accounting session to which the ReportingPeriod belongs.
      :type session: Session

      :raises DuplicateReportingPeriodError: If there already exists a Reporting Period
          for the same calendar year.
      :raises MultipleOpenPeriodsError: If there already exists a Reporting Period
          in the OPEN status.

      :returns: None


   .. py:method:: interval(date: datetime.datetime = None) -> dict

      Returns the start and end dates of the Reporting Period.

      :param session: The accounting session to which the Reporting Period
                      belongs.
      :type session: Session
      :param date: The date for whose Reporting Period's interval is to
                   be found.
      :type date: datetime

      :raises MissingReportingPeriodError: If there no Reporting Period exists for the
          given date.

      :returns: The Reporting Period.
      :rtype: ReportingPeriod



.. py:class:: Entity


   Bases: :py:obj:`python_accounting.models.Recyclable`

   Represents the Reporting Entity.

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Entity database record.

      :type: (int)

   .. py:attribute:: name
      :type: sqlalchemy.orm.Mapped[str]

      The Name of the Entity.

      :type: (str)

   .. py:attribute:: multi_currency
      :type: sqlalchemy.orm.Mapped[bool]

      Determines if the Entity can
      have Transactions in currencies other than its base Currency.
      Defaults to False.

      :type: (`bool`, optional)

   .. py:attribute:: mid_year_balances
      :type: sqlalchemy.orm.Mapped[bool]

      Determines if the Entity
      can have Opening Balances withing the current Reporting Period.
      Defaults to False.

      :type: (`bool`, optional)

   .. py:attribute:: year_start
      :type: sqlalchemy.orm.Mapped[int]

      The month at which the Entity's Reporting
      Periods begin, expressed as a number between 1 and 12. Defaults to 1
      (January).

      :type: (`int`, optional)

   .. py:attribute:: locale
      :type: sqlalchemy.orm.Mapped[str]

      The language format to be used to represent amounts. Defaults to en_GB.

      :type: (str)

   .. py:attribute:: currency_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Reporting Currency of the Entity.

      :type: (`int`, optional)

   .. py:attribute:: reporting_period_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the current Reporting Period of the Entity.

      :type: (`int`, optional)

   .. py:attribute:: currency
      :type: sqlalchemy.orm.Mapped[Currency]

      The Reporting Currency of the Entity.

      :type: (Currency)

   .. py:attribute:: reporting_period
      :type: sqlalchemy.orm.Mapped[python_accounting.models.ReportingPeriod]

      The current Reporting Period of the Entity.

      :type: (ReportingPeriod)

   .. py:attribute:: users
      :type: sqlalchemy.orm.Mapped[List[User]]

      A list of Users that belong to the Entity.

      :type: (`list` of User)

   .. py:method:: __repr__() -> str



.. py:class:: Account


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.recyclable.Recyclable`

   Represents an account which groups related Transactions.

   .. py:attribute:: AccountType

      Account Types as defined by IFRS and GAAP.

      :type: (StrEnum)

   .. py:attribute:: purchasables

      A list of Account
      Types that can be used in purchasing Transactions.

      :type: (`list` of `Account.AccountType`)

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Account database record.

      :type: (int)

   .. py:attribute:: name
      :type: sqlalchemy.orm.Mapped[str]

      The label of the Account.

      :type: (str)

   .. py:attribute:: description
      :type: sqlalchemy.orm.Mapped[str]

      A narration of the purpose of the Account.

      :type: (`str`, optional)

   .. py:attribute:: account_code
      :type: sqlalchemy.orm.Mapped[int]

      A serially generated code based on the type of the Account.

      :type: (int)

   .. py:attribute:: account_type
      :type: sqlalchemy.orm.Mapped[strenum.StrEnum]

      The type of the Account.

      :type: (AccountType)

   .. py:attribute:: currency_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Currency model associated with the Account.

      :type: (int)

   .. py:attribute:: category_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Category model to which the Account belongs.

      :type: (`int`, optional)

   .. py:attribute:: currency
      :type: sqlalchemy.orm.Mapped[Currency]

      The Currency associated with the Account.

      :type: (Currency)

   .. py:attribute:: category
      :type: sqlalchemy.orm.Mapped[Category]

      The Category to which the Account belongs.

      :type: (`Category`, optional)

   .. py:method:: _get_account_code(session) -> int


   .. py:method:: __repr__() -> str


   .. py:method:: balance_movement(session, start_date: datetime.datetime, end_date: datetime.datetime) -> decimal.Decimal

      Get the change in the account balance between the given dates.

      :param session: The accounting session to which the Account belongs.
      :type session: Session
      :param start_date: The earliest transaction date for Transaction amounts to be
                         included in the balance.
      :type start_date: datetime
      :param end_date: The latest transaction date for Transaction amounts to be included
                       in the balance.
      :type end_date: datetime

      :returns: The difference between the balance of the Account at the start date and
                end date.
      :rtype: Decimal


   .. py:method:: section_balances(session, account_types: list, start_date: datetime.datetime = None, end_date: datetime.datetime = None, full_balance: bool = True) -> dict
      :staticmethod:

      Gets the opening, movement and closing balances of the accounts of the given section
      (account types), organized by category.

      :param session: The accounting session to which the Account belongs.
      :type session: Session
      :param account_types: The Account types
                            belonging to the section.
      :type account_types: `list` of `Account.AccountType`
      :param start_date: The earliest transaction date for Transaction amounts to be
                         included in the balance.
      :type start_date: datetime
      :param end_date: The latest transaction date for Transaction amounts to be included
                       in the balance.
      :type end_date: datetime
      :param full_balance: Whether to include opening balance amounts in the balance.
      :type full_balance: bool

      :returns: A summary of the total opening, balance movement and closing balance, which
                details of totals by Category and the Accounts contained in each Category.
                    - opening (Decimal): The sum of opening balances of Accounts in the section.
                    - movement (Decimal): The movememt of the balances of Accounts in the section.
                    - closing (Decimal): The sum of opening closing of Accounts in the section.
                    - categories (dict): The Accounts belonging to the section separated by Category.
      :rtype: dict


   .. py:method:: opening_balance(session, year: int = None) -> decimal.Decimal

      Gets the the opening balance for the account for the given year.

      :param session: The accounting session to which the Account belongs.
      :type session: Session
      :param year: The calendar year for which to retrieve the opening balance.
      :type year: int

      :returns: The total opening balance of the Account for the year.
      :rtype: Decimal


   .. py:method:: closing_balance(session, end_date: datetime.datetime = None) -> decimal.Decimal

      Gets the the closing balance of the Account as at the given date.

      :param session: The accounting session to which the Account belongs.
      :type session: Session
      :param end_date: The latest transaction date for Transaction
                       amounts to be included in the balance.
      :type end_date: datetime

      :returns: The total opening balance of the Account for the year.
      :rtype: Decimal


   .. py:method:: statement(session, start_date: datetime.datetime = None, end_date: datetime.datetime = None, schedule: bool = False) -> dict

      Gets a chronological listing of the Transactions posted to the Account between
          the dates given.

      :param session: The accounting session to which the Account belongs.
      :type session: Session
      :param start_date: The earliest transaction date for Transaction amounts
                         to be included in the statement.
      :type start_date: datetime
      :param end_date: The latest transaction date for Transaction amounts to
                       be included in the statement.
      :type end_date: datetime
      :param schedule: Whether to exclude assignable Transactions and only list
                       clearable Transactions with outstanding amounts.
      :type schedule: bool

      :raises InvalidAccountTypeError: If the Account type is not Receivable or Payable.

      :returns: With a A summary of the opening and closing balance in the case of
                a statement, the total, cleared and uncleared amounts if its a schedule
                together with a list of Transactions.

                Statements.
                    - opening_balance (Decimal): The balance of the Account at the beginning of the statement period.
                    - transactions (list): Transactions posted to the Account during the period.
                    - closing_balance (Decimal): The balance of the Account at the end of the statement period.
                Schedule.
                    - transactions (list): Outstanding clearable Transactions posted to the Account as at the end date.
                    - total_amount (Decimal): The total amount of the Transactions in the Schdeule.
                    - cleared_amount (Decimal): The amount of the Transactions in the Schdeule that has been cleared.
                    - uncleared_amount (Decimal): The amount of the Transactions in the Schdeule that is still outstanding.
      :rtype: dict


   .. py:method:: validate(session) -> None

      Validates the Account properties.

      :param session: The accounting session to which the Account belongs.
      :type session: Session

      :raises InvalidCategoryAccountTypeError: If the account type of the Account
          does not match that of its assigned Category.

      :returns: None


   .. py:method:: validate_delete(session) -> None

      Validates if the account can be deleted.

      :param session: The accounting session to which the Account belongs.
      :type session: Session

      :raises HangingTransactionsError: If the Account has had Transactions during the
          current Reporting period.

      :returns: None



.. py:class:: Category


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.Recyclable`

   Represents a grouping of Accounts of the same type.

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Category database record.

      :type: (int)

   .. py:attribute:: name
      :type: sqlalchemy.orm.Mapped[str]

      The label of the Category.

      :type: (str)

   .. py:attribute:: category_account_type
      :type: sqlalchemy.orm.Mapped[strenum.StrEnum]

      The Account type of the members of the Category.

      :type: (`list` of `Account.AccountType`)

   .. py:attribute:: accounts
      :type: sqlalchemy.orm.Mapped[List[python_accounting.models.Account]]

      Accounts that belong to the Category.

      :type: (list)

   .. py:method:: __repr__() -> str


   .. py:method:: validate(_) -> None

      Validates the Category properties.

      :param session: The accounting session to which the Category belongs.
      :type session: Session

      :raises InvalidAccountTypeError: If the category account type is not one of Account.AccountType.

      :returns: None


   .. py:method:: account_balances(session, end_date: datetime.datetime = None) -> dict

      Returns the Accounts belonging to the Category and their balances.

      :param session: The accounting session to which the Account belongs.
      :type session: Session
      :param end_date: The latest transaction date for Transaction amounts to be included in the Account balances.
      :type end_date: datetime

      :returns: With a A summary of the total of the Account balances of the together with a list
                of the Accounts themselves.
                    - total (Decimal): The total of the closing balances of the Category accounts as at the end date.
                    - accounts (list): The Accounts belonging to the Category.
      :rtype: dict



.. py:class:: LineItem(**kw: Any)


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.Recyclable`

   Represents the other side of the double entry from the main account of a Transaction.

   .. py:attribute:: __tablename__
      :value: 'line_item'

      

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Line Item database record.

      :type: (int)

   .. py:attribute:: narration
      :type: sqlalchemy.orm.Mapped[str]

      A short description of the Line Item's contribution to the Transaction.

      :type: (str)

   .. py:attribute:: quantity
      :type: sqlalchemy.orm.Mapped[decimal.Decimal]

      The multiple of the Line Item amount to be posted to the Ledger.

      :type: (Decimal)

   .. py:attribute:: amount
      :type: sqlalchemy.orm.Mapped[decimal.Decimal]

      The amount to be posted to the Line Item Account.

      :type: (Decimal)

   .. py:attribute:: credited
      :type: sqlalchemy.orm.Mapped[bool]

      Determines whether the Line Item amount will
      be posted to the credit side of the Line Item Account. Defaults to False.

      :type: (`bool`, optional)

   .. py:attribute:: tax_inclusive
      :type: sqlalchemy.orm.Mapped[bool]

      Determines whether the Tax amount of the
      Line Item is included in the Line Item amount. Defaults to False.

      :type: (`bool`, optional)

   .. py:attribute:: account_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Account model associated with the Line Item.

      :type: (int)

   .. py:attribute:: transaction_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Transaction model associated with the Line Item.

      :type: (`int`, optional)

   .. py:attribute:: tax_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Tax model associated with the Line Item.

      :type: (`int`, optional)

   .. py:attribute:: account
      :type: sqlalchemy.orm.Mapped[Account]

      The the Account model associated with the Line Item.

      :type: (Account)

   .. py:attribute:: tax
      :type: sqlalchemy.orm.Mapped[Tax]

      The Tax model associated with the Line Item.

      :type: (`Tax`, optional)

   .. py:attribute:: transaction
      :type: sqlalchemy.orm.Mapped[Transaction]

      The Transaction model associated with the Line Item.

      :type: (`Transaction`, optional)

   .. py:attribute:: ledgers
      :type: sqlalchemy.orm.Mapped[List[Ledger]]

      The Ledger models associated with the Line Item.

      :type: (list)

   .. py:method:: validate_ledgers(key, ledger, is_remove)

      Validates adding or removing of Line Item Ledgers.

      :raises ValueError: If the Line Item Ledgers are manually added or removed.


   .. py:method:: __repr__() -> str


   .. py:method:: validate(_) -> None

      Validates the Line Item properties.

      :param session: The accounting session to which the Line Item belongs.
      :type session: Session

      :raises NegativeValueError: If the Line Item amount or quantity is less than 0.

      :returns: None


   .. py:method:: validate_delete(session) -> None

      Validates if the line item can be deleted.




.. py:class:: Transaction


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.Recyclable`

   Represents a Transaction in the sense of an original source document.

   .. py:property:: tax
      :type: dict

      The taxes that have been applied to the transaction.
      - taxes (dict): The taxes applied to the Transaction and their amounts.
      - amount (str): The total tax applied to the Transaction.

   .. py:property:: is_posted
      :type: bool

      Check if the Transaction has been posted to the ledger

   .. py:property:: amount
      :type: decimal.Decimal

      The amount of the Transaction.

   .. py:attribute:: TransactionType

      Transaction Types representing standard source document Transactions.

      :type: (StrEnum)

   .. py:attribute:: __table_args__
      :value: ()

      

   .. py:attribute:: __tablename__
      :value: 'transaction'

      

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Transaction database record.

      :type: (int)

   .. py:attribute:: transaction_date
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The date of the Transaction.

      :type: (datetime)

   .. py:attribute:: transaction_no
      :type: sqlalchemy.orm.Mapped[str]

      Serially generated indentifier for the Transaction

      :type: (str)

   .. py:attribute:: transaction_type
      :type: sqlalchemy.orm.Mapped[strenum.StrEnum]

      The Transaction type of the Transaction.

      :type: (TransactionType)

   .. py:attribute:: narration
      :type: sqlalchemy.orm.Mapped[str]

      A short description of the purpose of the Transaction.

      :type: (str)

   .. py:attribute:: reference
      :type: sqlalchemy.orm.Mapped[str]

      Identifying information about the Transaction.

      :type: (`str`, optional)

   .. py:attribute:: main_account_amount
      :type: sqlalchemy.orm.Mapped[decimal.Decimal]

      The amount to be posted to the Transaction
      main Account. Only applies to compound (Journal Entry) Transactions.

      :type: (`Decimal`, optional)

   .. py:attribute:: credited
      :type: sqlalchemy.orm.Mapped[bool]

      Determines whether the Transaction amount will
      be posted to the credit side of the main Account. Defaults to True.

      :type: (`bool`, optional)

   .. py:attribute:: compound
      :type: sqlalchemy.orm.Mapped[bool]

      Determines whether the (Journal Entry) Transaction amount
      can have Line Items on both sides of the double entry.

      :type: (`bool`, optional)

   .. py:attribute:: currency_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Currency associated with the Transaction.

      :type: (int)

   .. py:attribute:: account_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Account model to which Transaction amounts are to be posted.

      :type: (int)

   .. py:attribute:: currency
      :type: sqlalchemy.orm.Mapped[Currency]

      The Currency associated with the Transaction.

      :type: (Currency)

   .. py:attribute:: account
      :type: sqlalchemy.orm.Mapped[python_accounting.models.Account]

      The Account model to which Transaction amounts are to be posted.

      :type: (Account)

   .. py:attribute:: line_items
      :type: sqlalchemy.orm.Mapped[Set[python_accounting.models.LineItem]]

      The Line Items models associated with the Transaction.

      :type: (Set)

   .. py:attribute:: ledgers
      :type: sqlalchemy.orm.Mapped[List[Ledger]]

      The Ledger models associated with the Transaction.

      :type: (list)

   .. py:method:: validate_line_items(key, line_item, is_remove)

      Validates adding or removing of Transaction Line Items.

      :raises PostedTransactionError: If the Transaction is posted and Line Items are added or removed from it.
      :raises ValueError: If the unsaved Line Item are added or removed from the Transaction.


   .. py:method:: validate_ledgers(key, ledger, is_remove)

      Validates adding or removing of Transaction Ledgers

      :raises ValueError: If the Transaction Ledgers are manually added or removed.


   .. py:method:: __repr__() -> str


   .. py:method:: _get_main_account(session) -> python_accounting.models.Account


   .. py:method:: _transaction_no(session, transaction_type, reporting_period) -> str


   .. py:method:: is_secure(session) -> bool

      Verify that the Transaction's Ledgers have not been tampered with.


   .. py:method:: post(session) -> None

      Posts the Transaction to the Ledger.

      :param session: The accounting session to which the Reporting Period
                      belongs.
      :type session: Session

      :raises MissingLineItemError: If the Transaction has no Line Items.

      :returns: None


   .. py:method:: contribution(session, account: python_accounting.models.Account) -> decimal.Decimal

      Gets the amount contributed by the account to the transaction total.

      :param session: The accounting session to which the Reporting Period
                      belongs.
      :type session: Session
      :param account: The Account who's contribution is to be found.
      :type account: Account

      :returns: The amount posted to the Account by the Transaction.
      :rtype: Decimal


   .. py:method:: validate(session) -> None

      Validates the Transaction properties.

      :param session: The accounting session to which the Balance belongs.
      :type session: Session

      :raises PostedTransactionError: If Transaction is already posted.
      :raises ClosedReportingPeriodError: If the Transaction date is with a Reporting Period
          in the CLOSED status.
      :raises AdjustingReportingPeriodError: If the Transaction date is with a Reporting Period
          in the ADJUSTING status and is not a Journal Entry.
      :raises InvalidTransactionDateError: If the Transaction date is exactly the beginning of
          the Reporting Period.
      :raises InvalidTransactionTypeError: If the Transaction type is being modified.
      :raises RedundantTransactionError: If the Transaction main Account is also one of its
          Line Items Accounts.

      :returns: None


   .. py:method:: validate_delete(_) -> None

      Validates if the Transaction can be deleted.

      :param session: The accounting session to which the Balance belongs.
      :type session: Session

      :raises PostedTransactionError: If Transaction is already posted.

      :returns: None



.. py:class:: Balance


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.mixins.ClearingMixin`, :py:obj:`python_accounting.models.Recyclable`

   Represents a Balance brought down from previous Reporting Periods.

   .. py:property:: is_posted
      :type: bool

      is_posted analog for the assignment model.

   .. py:property:: credited
      :type: bool

      credited analog for the assignment model.

   .. py:property:: compound
      :type: bool

      compound analog for the assignment model.

   .. py:attribute:: BalanceType

      The double entry types of Balances.

      :type: (StrEnum)

   .. py:attribute:: BalanceTransactions

      A list of Transaction Types that can have Balances.

      :type: (StrEnum)

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Account database record.

      :type: (int)

   .. py:attribute:: transaction_date
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The date of the Balance Transaction.

      :type: (datetime)

   .. py:attribute:: reference
      :type: sqlalchemy.orm.Mapped[str]

      Identifying information about the Balance Transaction.

      :type: (`str`, optional)

   .. py:attribute:: transaction_no
      :type: sqlalchemy.orm.Mapped[str]

      The Transaction number of the Balance Transaction.

      :type: (str)

   .. py:attribute:: transaction_type
      :type: sqlalchemy.orm.Mapped[strenum.StrEnum]

      The Transaction type of the Balance Transaction.

      :type: (TransactionType)

   .. py:attribute:: amount
      :type: sqlalchemy.orm.Mapped[decimal.Decimal]

      The amount outstanding on the Balance Transaction.

      :type: (Decimal)

   .. py:attribute:: balance_type
      :type: sqlalchemy.orm.Mapped[strenum.StrEnum]

      The side of the double entry to post the Balance amount.

      :type: (BalanceType)

   .. py:attribute:: currency_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Currency model associated with the Balance.

      :type: (int)

   .. py:attribute:: account_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Account model to which the Balance belongs.

      :type: (int)

   .. py:attribute:: reporting_period_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Reporting Period model to which the Balance belongs.

      :type: (int)

   .. py:attribute:: currency
      :type: sqlalchemy.orm.Mapped[python_accounting.models.Currency]

      The Currency model associated with the Balance.

      :type: (Currency)

   .. py:attribute:: account
      :type: sqlalchemy.orm.Mapped[python_accounting.models.Account]

      The Account model to which the Balance belongs.

      :type: (Account)

   .. py:attribute:: reporting_period
      :type: sqlalchemy.orm.Mapped[python_accounting.models.ReportingPeriod]

      The Reporting Period model to which the Balance belongs.

      :type: (ReportingPeriod)

   .. py:method:: __repr__() -> str


   .. py:method:: opening_trial_balance(session, year: int = None) -> dict
      :staticmethod:

      Gets the total opening balances for the Entity's accounts for the given year.

      :param session: The accounting session to which the Account belongs.
      :type session: Session
      :param year: The calendar year to retrieve the opening
                   trial balance for. Defaults to the Balance's Entity current Reporting
                   Period's calendar year.
      :type year: `int`, optional

      :returns: With a A summary of the debit and credit balances of the Accounts
                together with a list of the Accounts themselves.
                    - debits (Decimal): The total debit balance.
                    - credits (Decimal): The total credit balance.
                    - accounts (Decimal): Accounts constituting the opening trial balance.
      :rtype: dict


   .. py:method:: validate(session) -> None

      Validates the Balance properties.

      :param session: The accounting session to which the Balance belongs.
      :type session: Session

      :raises NegativeValueError: If the Balance amount is less than 0.
      :raises InvalidBalanceAccountError: If the Balance main Account is an Income Statement Account.
      :raises InvalidBalanceTransactionError: If the Balance Transaction type is not one of the Balance Transaction types.
      :raises InvalidBalanceDateError: If the Balance Transaction date is within the current reporting period and the Entity does not allow mid year balances.

      :returns: None



.. py:class:: Tax


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.Recyclable`

   Represents a Tax applied to a Transaction's Line Item.

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the Tax database record.

      :type: (int)

   .. py:attribute:: name
      :type: sqlalchemy.orm.Mapped[str]

      The label of the Tax.

      :type: (str)

   .. py:attribute:: code
      :type: sqlalchemy.orm.Mapped[str]

      A shorthand representation of the Tax.

      :type: (str)

   .. py:attribute:: rate
      :type: sqlalchemy.orm.Mapped[decimal.Decimal]

      The percentage rate of the Tax.

      :type: (Decimal)

   .. py:attribute:: account_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Account model to which Tax amounts are posted.

      :type: (int)

   .. py:attribute:: account
      :type: sqlalchemy.orm.Mapped[python_accounting.models.Account]

      The Account model to which Tax amounts are posted.

      :type: (Account)

   .. py:method:: __repr__() -> str


   .. py:method:: validate(session) -> None

      Validates the Tax properties.

      :param session: The accounting session to which the Balance belongs.
      :type session: Session

      :raises NegativeValueError: If the Tax rate is less than 0.
      :raises MissingTaxAccountError: If the Tax rate is greater than 0 and the Tax Account is not set.
      :raises InvalidTaxAccountError: If the Tax Account type is not Control.

      :returns: None


   .. py:method:: validate_delete(session) -> None

      Validates if the Tax can be deleted.

      :param session: The accounting session to which the Tax belongs.
      :type session: Session

      :raises HangingTransactionsError: If there exists posted Transactions with Line Items that have this Tax applied to them.

      :returns: None



.. py:class:: Ledger


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.Recyclable`

   Represents an entry in the Ledger. (Should never have to be invoked directly).

   .. py:attribute:: __mapper_args__

      

   .. py:attribute:: id
      :type: sqlalchemy.orm.Mapped[int]

      The primary key of the ledger database record.

      :type: (int)

   .. py:attribute:: transaction_date
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The date of the Transaction associated with the Ledger.

      :type: (datetime)

   .. py:attribute:: entry_type
      :type: sqlalchemy.orm.Mapped[strenum.StrEnum]

      The side of the double entry to which the Ledger is posted.

      :type: (BalanceType)

   .. py:attribute:: amount
      :type: sqlalchemy.orm.Mapped[decimal.Decimal]

      The amount posted to the Ledger by the entry.

      :type: (Decimal)

   .. py:attribute:: hash
      :type: sqlalchemy.orm.Mapped[str]

      The encoded contents of the Ledger entry.

      :type: (str)

   .. py:attribute:: transaction_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Transaction associated with the Ledger.

      :type: (int)

   .. py:attribute:: currency_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Currency associated with the Ledger.

      :type: (int)

   .. py:attribute:: post_account_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Account to which the Ledger is posted.

      :type: (int)

   .. py:attribute:: folio_account_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Account to which the opposite side of Ledger is posted.

      :type: (int)

   .. py:attribute:: line_item_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Line Item associated with the Ledger.

      :type: (`int`, optional)

   .. py:attribute:: tax_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the Tax associated with the Ledger.

      :type: (`int`, optional)

   .. py:attribute:: transaction
      :type: sqlalchemy.orm.Mapped[python_accounting.models.Transaction]

      The Transaction associated with the Ledger.

      :type: (Transaction)

   .. py:attribute:: currency
      :type: sqlalchemy.orm.Mapped[Currency]

      The Currency associated with the Ledger.

      :type: (Currency)

   .. py:attribute:: post_account
      :type: sqlalchemy.orm.Mapped[Account]

      The main Account associated with the Ledger.

      :type: (Account)

   .. py:attribute:: folio_account
      :type: sqlalchemy.orm.Mapped[Account]

      The oppeite double entry Account associated with the Ledger.

      :type: (Account)

   .. py:attribute:: line_item
      :type: sqlalchemy.orm.Mapped[LineItem]

      The LineItem associated with the Ledger.

      :type: (LineItem)

   .. py:method:: __repr__() -> str


   .. py:method:: _allocate_amount(session, post, amount, posts, folios, transaction, entry_type) -> None
      :staticmethod:


   .. py:method:: _make_compound_ledgers(session, posts: list, folios: list, transaction: python_accounting.models.Transaction, entry_type: python_accounting.models.Balance.BalanceType) -> None
      :staticmethod:


   .. py:method:: _post_compound(session, transaction: python_accounting.models.Transaction) -> None
      :staticmethod:


   .. py:method:: _transaction_ledgers(transaction: python_accounting.models.Transaction) -> tuple
      :staticmethod:


   .. py:method:: _post_simple(session, transaction: python_accounting.models.Transaction) -> None
      :staticmethod:


   .. py:method:: post(session, transaction: python_accounting.models.Transaction) -> None
      :staticmethod:

      Posts the Transaction to the ledger.

      :param session: The accounting session to which the Account belongs.
      :type session: Session
      :param transaction: The Transaction to be posted.
      :type transaction: Transaction


   .. py:method:: get_hash(connection) -> None

      Calculate the hash of the Ledger.

      :param connection: The database connection of the accounting session
      :type connection: Connection
      :param to which the Ledger belongs.:

      :returns: None



.. py:class:: Assignment


   Bases: :py:obj:`python_accounting.mixins.IsolatingMixin`, :py:obj:`python_accounting.models.Base`

   Represents an assigment of a clearable type to an assignable Transaction.

   .. py:attribute:: clearables

      A list of Transaction Types
      that can be cleared by assignable Transactions.

      :type: (`list` of `Transaction.TransactionType`)

   .. py:attribute:: assignables

      A list of Transaction Types
      that can have cleareable Transactions assigned to them.

      :type: (`list` of `Transaction.TransactionType`)

   .. py:attribute:: assignment_date
      :type: sqlalchemy.orm.Mapped[datetime.datetime]

      The date of the Assignment.

      :type: (datetime)

   .. py:attribute:: transaction_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the assignable Transaction in the Assignment.

      :type: (int)

   .. py:attribute:: assigned_id
      :type: sqlalchemy.orm.Mapped[int]

      The id of the clearable Transaction|Balance in the Assignment.

      :type: (int)

   .. py:attribute:: assigned_type
      :type: sqlalchemy.orm.Mapped[str]

      The class name of the clearable Transaction|Balance in the Assignment.

      :type: (str)

   .. py:attribute:: assigned_no
      :type: sqlalchemy.orm.Mapped[str]

      The Transaction number of the clearable Transaction|Balance in the Assignment.

      :type: (str)

   .. py:attribute:: amount
      :type: sqlalchemy.orm.Mapped[decimal.Decimal]

      The amount of the Assignment.

      :type: (Decimal)

   .. py:attribute:: transaction
      :type: sqlalchemy.orm.Mapped[python_accounting.models.Transaction]

      The assignable Transaction in the Assignment.

      :type: (Transaction)

   .. py:method:: __repr__() -> str


   .. py:method:: assigned(session) -> python_accounting.models.Transaction | python_accounting.models.Balance

      Get the clearable Transaction|Balance assigned to this assigment's transaction.

      :param session: The accounting session to which the Assignment belongs.
      :type session: Session

      :returns: The model cleared by this assignment.
      :rtype: Transaction|Balance


   .. py:method:: validate(session) -> None

      Validates the Assignment properties.

      :param session: The accounting session to which the Assignment belongs.
      :type session: Session

      :raises ValueError: If the assignable Transaction or clearable Transaction|Balance could not be found.
      :raises UnassignableTransactionError: If the assignable Transaction type is not one of the assignable types.
      :raises UnclearableTransactionError: If the clearable Transaction type is not one of the clearable types.
      :raises UnpostedAssignmentError: If either the assignable or clearable Transaction is not posted.
      :raises InsufficientBalanceError: If the remaining balance in the assignable Transaction is less than the Assignment amount.
      :raises OverclearanceError: If the Assignment amount is greater than the clearable Transaction|Balance uncleared amount.
      :raises CompoundTransactionAssignmentError: If either the assignable or clearable Journal Entry is a compound Transaction.
      :raises SelfClearanceError: If the assignable and clearable Transaction of the Assignment is the same.
      :raises InvalidAssignmentAccountError: If the assignable Transaction and clearable Transaction|Balance main Accounts are not the same.
      :raises MixedAssignmentError: If either an already Transaction is being cleared or an already cleared Transaction is being assigned.

      :returns: None



